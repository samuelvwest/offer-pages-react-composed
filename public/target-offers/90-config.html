<script>
    // Prepare React setup function if not defined yet
    window.tao.f.setupMVTScripts = window.tao.f.setupMVTScripts || function() {
        if (!window.tao.g.setupMVTScriptRun) {
            // Adjust styles for other elements on page
            tao.f.insertNode(`
                <style id="mvtSetupStyles">
                    body > *:not(.mvtShow) { 
                        display: none; 
                    } 
                </style>`, document.body, 'prepend');
            tao.f.windu({
                name: 'placeHideExcluders',
                selector: '#HeaderRegion, #BannerRegion, #FooterRegion, .highlightedMbox',
                attach: function(elem) {
                    elem.classList.add('mvtShow')
                }
            });
            tao.f.windu({
                name: 'removePageStyles',
                selector: 'body > style:not(#mvtSetupStyles)',
                attach: function(elem) {
                    tao.f.removeNode(elem);
                }
            })
            // Place React App Dom Element
            tao.f.windu({
                name: 'placeReactApp',
                when: function() {
                    return !!document.getElementById('HeaderRegion');
                },
                do: function() {
                    tao.f.insertNode('<style id="mvtHideBodyStyle">#app.mvtShow { opacity: 0; }</style>', document.head);
                    tao.f.insertNode('<div id="app" class="mvtShow"></div>', document.getElementById('HeaderRegion'), 'after');

                    // Show body after styles and scripts are loaded
                    tao.g.mvtAppFilesLoaded = 0;
                    tao.f.showMVTApp = () => {
                        tao.g.mvtAppFilesLoaded++;
                        if (tao.g.mvtAppFilesLoaded > 1) {
                            tao.f.removeNode(document.getElementById('mvtHideBodyStyle'))
                        }
                    }

                    // App Styles
                    var mvtStyles = document.createElement('link');
                        mvtStyles.type = "text/css";
                        mvtStyles.rel = "stylesheet";
                        mvtStyles.href = 'https://www.ancestrycdn.com/mars/landing/offer-page-spa/v2/1/2/styles.css';
                        mvtStyles.setAttribute("onload", "tao.f.showMVTApp();");
                    document.head.appendChild(mvtStyles);

                    // App Script
                    var mvtScript = document.createElement('script');
                        mvtScript.type = 'text/javascript';
                        mvtScript.src = 'https://www.ancestrycdn.com/mars/landing/offer-page-spa/v2/1/2/bundle.js';
                        mvtScript.setAttribute("onload", "tao.f.showMVTApp();");
                    document.head.appendChild(mvtScript);
                }
            });
            // prevent duplicate function runs
            window.tao.g.setupMVTScriptRun = true;
        }
    }
    // Run React Setup function in case it hasn't run yet.
    window.tao.f.setupMVTScripts();



    // Profile Attribute check/set
    // if ('${profile.someCustomProfileAttribute}' !== "true") {
    //     console.log("Entered test = ",'${profile.someCustomProfileAttribute}');
    //     adobe.target.trackEvent({
    //         mbox: 'entered-health-flow-test',
    //         params: {
    //             'profile.someCustomProfileAttribute': "true"
    //         }
    //     });
    // }


    // Profile Attribute check/set
    var entryProfileStr = '${profile.presentationMessageEntry}';
    // console.log('profile.presentationMessageEntry', !!entryProfileStr);
    if (entryProfileStr !== 'true') {
        window.tao.g.additionalVariantAttributes = {
            presentationMessageEntry: true,
            'profile.presentationMessageEntry': 'true'
        }
    }
    // console.log(window.tao.g.additionalVariantAttributes);
</script>